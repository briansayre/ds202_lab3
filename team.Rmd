```{r}
library(dplyr)
library(tidyverse)
library(ggplot2)
data <- readxl::read_xls('./GSS.xls')
df <- data.frame( year=data$`Gss year for this respondent`, happy=data$`General happiness`, party=data$`Political party affiliation`, income=data$`Total family income`, race=data$`Race of respondent`, sex=data$`Respondents sex`, school=data$`Highest year of school completed`, mstatus=data$`Marital status`, id=data$`Respondent id number`, ballot=data$`Ballot used for interview` ) 
str(df)
```

1.   
I chose to display the data as a boxplot for each marriage status. I chose this to show as mush information about the education for each status as possible. We can see that the ones with no answer seem to have the highest mean education which is something I did not expect. We also can see the rest have around the same mean, but a difference in most of their interquartile ranges. Divorced, married and never married seem to have a higher IQR than separated and widowed.
```{r}
q1df <- as.data.frame(df)
q1df <- filter(q1df, school != 'No answer' & school != "Don't know" & !is.na(school) & school != "NA" )
unique(q1df$school)
q1df$school <- as.numeric(q1df$school)
ggplot(q1df, aes(y=school, x=mstatus), fill=school) + geom_boxplot()
```

```{r}
q1df %>% 
  group_by(mstatus) %>% 
  summarize(
    mean_rate = mean(school, na.rm=TRUE),
    sd_rate = sd(school, na.rm=TRUE),
    nrows = n()
  )
```


2.  
```{r}
q2df <- q1df %>% 
  group_by(mstatus) %>% 
  filter(school > mean(school))
str(q2df)
```

3.  
It seems that those who are married tend to be "Very Happy" or just happy overall. Most people seem to be married and a majority in that category are happy. We can see the few that are separated do not seem to be too happy and those who are divorced are also not as happy as those who are married. There also seems to be more unhappy non-married people than there are unhappy married people.
```{r}
happy_df <- as.data.frame(df)
unique(df$happy)
unique(df$mstatus)
isHappy_df <- filter(happy_df, happy!="No answer"
                   && happy!="Not applicable" && happy!="Don't know") 
isHappy_df <- filter(isHappy_df, mstatus!="No answer")
```
```{r}
mosaicplot(isHappy_df$happy~isHappy_df$mstatus, col=c("red", "blue"))
mosaicplot(isHappy_df$mstatus~isHappy_df$happy, col=c("red", "blue"))
```


## Problem 5
```{r}
q5df <- as.data.frame(df)
q5df <- filter(q5df, school != 'No answer' & school != "Don't know" & !is.na(school) & school != "NA" )
unique(q5df$school)
q5df$school <- as.numeric(q5df$school)
```


```{r}
##plot of marital status and education
ggplot(data=q5df, aes(x=mstatus,y=school))+geom_boxplot()+ggtitle("Marital Status vs. Education")+theme(axis.text.x = element_text(angle = 90))+xlab("Marital Status")
```

The group with the highest median years of education was the "No Answer" group, while the group with the lowest median years of education was Widowed people. Since the no answer group likely has less respondents than the other groups, they are likely to get more average responses for years of schooling than the other groups.

```{r}
ggplot(data=q5df, aes(x=mstatus, y=school))+geom_bar(stat = 'identity')+xlab("Marital Status")+ggtitle("Marital Status vs. Total Education Bar Graph")
```

Overall, the group of married people has the highest total amount of education, distantly followed by the never married group. Since this is the total education though, we can not tell if this is solely due to married people having more education or if there were just many more married people than other groups. This graph also shows that the total education of the No Answer group is much less than the total education for all other groups.

## Problem 6A
```{r}
##exploring relationship between race and education
q6dfA <- select(df, race, school)
q6dfA <- filter(q6dfA, school != 'No answer' & school != "Don't know" & !is.na(school) & school != "NA" )
```

```{r}
##exploring school variable
q6dfA$school <- as.numeric(q6dfA$school)
ggplot(q6dfA, aes(x=school))+geom_bar()+xlab("Education")+ ylab("Count")+ggtitle("Counts of Years of Education")
```

The most common amount of education of respondents for the study was 12 years of school, which means that more respondents received a high school education than any other number of years of education. The data is skewed to the left with a center around 12 years of education.

```{r}
##exploring race variable
ggplot(q6dfA, aes(x=race))+geom_bar()+xlab("Race")+ylab("Count")+ggtitle("Number of Respondents per Race")
```

There are approximately 5 times as many white respondents as the next largest category (black respondents). The majority of the data collected was from white-identifying people. There is still a sizeable amount of data for both the black and other people.

```{r}
##exploring the relationship between race and school
ggplot(data=q6dfA, aes(x=race, y=school))+geom_boxplot()+ggtitle("Race vs. Education")
```

The median years of education for both black and white people is about 12 years while the median years of education for the other races is 13 years. Overall, black people tended to have lower education than white people and the other races had the widest range. This could be because the other category includes many other races like latinos and asians. 


6b.  
Does income affect your overall happiness?  
The graph and data show that as a persons income increases the average happiness rating increases. For the data, i used "Not too happy" = 1, "Pretty happy" = 2, "Very happy" = 3. This allowed me to run an average of each person for each income range. Although the happiness slightly increase as income increases, we can see that they are all still right around a 2 average, which is pretty happy.

```{r}
q6df <- select(df,happy, income)
q6df <- filter(q6df, happy != "No answer" & happy != "Don't know" & happy != "Not applicable")
q6df <- filter(q6df, income != "No answer" & income != "Don't know" & income != "Not applicable" & income != "Refused")
q6df$happyNum <- recode(q6df$happy, "Not too happy" = 1, "Pretty happy" = 2, "Very happy" = 3)
q6df <- aggregate(q6df$happyNum, by=list(q6df$income), FUN=mean)
q6qf <- rename(q6df, Income = Group.1, Happiness = x)
ordered <- c("Lt $1000", "$1000 to 2999", "$3000 to 3999", "$4000 to 4999", "$5000 to 5999", "$6000 to 6999", "$7000 to 7999", "$8000 to 9999", "$10000 - 14999", "$15000 - 19999", "$20000 - 24999", "$25000 or more")
q6qf$Income <- factor(q6qf$Income, levels=ordered)
```
```{r}
ggplot(q6qf, aes(y=Happiness, x=Income)) + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = -90))+ ylim(0, 3)
```
```{r}
q6qf
```
